(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{571:function(s,t,a){s.exports=a.p+"assets/img/hive-01.1cc0a2b9.jpg"},663:function(s,t,a){"use strict";a.r(t);var e=a(9),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"数据导入"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#数据导入"}},[s._v("#")]),s._v(" 数据导入")]),s._v(" "),e("h3",{attrs:{id:"load"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#load"}},[s._v("#")]),s._v(" load")]),s._v(" "),e("p",[e("strong",[s._v("语法：")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("hive"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" load data "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("local"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" inpath "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'数据的 path'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("overwrite"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" into table student "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("partition "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("partcol1"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("val1,…"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ol",[e("li",[s._v("load data:表示加载数据")]),s._v(" "),e("li",[s._v("local:表示从本地加载数据到 hive 表；否则从 HDFS 加载数据到 hive 表")]),s._v(" "),e("li",[s._v("inpath:表示加载数据的路径")]),s._v(" "),e("li",[s._v("overwrite:表示覆盖表中已有数据，否则表示追加")]),s._v(" "),e("li",[s._v("into table:表示加载到哪张表")]),s._v(" "),e("li",[s._v("student:表示具体的表")]),s._v(" "),e("li",[s._v("partition:表示上传到指定分区")])]),s._v(" "),e("p",[e("strong",[s._v("本地：")])]),s._v(" "),e("div",{staticClass:"language-创建一张表 line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("load data local inpath '/opt/module/hive/datas/student.txt' into table default.student;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("HDFS")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("load data inpath "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/user/atguigu/hive/student.txt'")]),s._v(" into table default.student"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("加载数据覆盖表中已有的数据")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("load data inpath "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/user/atguigu/hive/student.txt'")]),s._v(" overwrite into table default.student"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"insert"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#insert"}},[s._v("#")]),s._v(" Insert")]),s._v(" "),e("p",[e("strong",[s._v("基本插入数据")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("insert into table student_par values"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'wangwu'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'zhaoliu'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("基本模式插入（根据单张表查询结果）")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("insert overwrite table student_par\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" id, name from student where "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("month")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'201709'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("insert into：以追加数据的方式插入到表或分区，原有数据不会删除")]),s._v(" "),e("p",[s._v("insert overwrite：会覆盖表中已存在的数据")]),s._v(" "),e("p",[s._v("**注意：**insert 不支持插入部分字段")]),s._v(" "),e("h3",{attrs:{id:"创建表时插入数据-as-select"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建表时插入数据-as-select"}},[s._v("#")]),s._v(" 创建表时插入数据（As Select）")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("create table "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" not exists student3 \nas "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" id, name from student"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"创建表时指定加载路径-hdfs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建表时指定加载路径-hdfs"}},[s._v("#")]),s._v(" 创建表时指定加载路径（HDFS）")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("create external table "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" not exists student5"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" int, name string\n "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n row "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("format")]),s._v(" delimited fields terminated by "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\t'")]),s._v("\n location '/student"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h1",{attrs:{id:"数据导出"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#数据导出"}},[s._v("#")]),s._v(" 数据导出")]),s._v(" "),e("h3",{attrs:{id:"insert导出"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#insert导出"}},[s._v("#")]),s._v(" Insert导出")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("导出到本地")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("insert overwrite "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" directory "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/opt/module/hive/data/export/student'")]),s._v(" \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" * from student"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("格式化导出到本地")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("insert overwrite "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" directory "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/opt/module/hive/data/export/student1'")]),s._v("\nROW FORMAT DELIMITED FIELDS TERMINATED BY "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\t'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" * from student"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("将查询结果导出到HDFS上(没有local)")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("insert overwrite directory "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/user/atguigu/student2'")]),s._v("\nROW FORMAT DELIMITED FIELDS TERMINATED BY "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\t'")]),s._v(" \n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" * from student"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("hadoop命令导出到本地")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("dfs -get /user/hive/warehouse/student/student.txt /opt/module/data/export/student3.txt"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("Hive Shell命令导出（hive -f/-e 执行语句或者脚本 > file）")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v(" bin/hive -e "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'select * from default.student;'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /opt/module/hive/data/export/student4.txt"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("Export导出到HDFS上")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" table default.student to "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/user/hive/warehouse/export/student'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"清除表中数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#清除表中数据"}},[s._v("#")]),s._v(" 清除表中数据")]),s._v(" "),e("p",[s._v("Truncate 只能删除管理表，不能删除外部表中数据")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("truncate table student"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h1",{attrs:{id:"数据查询"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#数据查询"}},[s._v("#")]),s._v(" 数据查询")]),s._v(" "),e("p",[e("strong",[s._v("注意：")])]),s._v(" "),e("ol",[e("li",[s._v("SQL 语言大小写不敏感")]),s._v(" "),e("li",[s._v("SQL 可以写在一行或者多行")]),s._v(" "),e("li",[s._v("关键字不能被缩写也不能分行")]),s._v(" "),e("li",[s._v("各子句一般要分行写")]),s._v(" "),e("li",[s._v("使用缩进提高语句的可读性")])]),s._v(" "),e("h3",{attrs:{id:"比较运算符"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#比较运算符"}},[s._v("#")]),s._v(" 比较运算符")]),s._v(" "),e("p",[e("img",{attrs:{src:a(571),alt:""}})]),s._v(" "),e("h3",{attrs:{id:"like和rlike"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#like和rlike"}},[s._v("#")]),s._v(" Like和RLike")]),s._v(" "),e("ol",[e("li",[s._v("% 代表零个或多个字符(任意个字符)")]),s._v(" "),e("li",[s._v("_ 代表一个字符")]),s._v(" "),e("li",[s._v("RLIKE 子句是 Hive 中这个功能的一个扩展，其可以通过 Java 的正则表达式这个更强大的语言来指定匹配条件")])]),s._v(" "),e("h1",{attrs:{id:"join"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#join"}},[s._v("#")]),s._v(" Join")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("内连接")]),s._v(" "),e("p",[s._v("内连接：只有进行连接的两个表中都存在与连接条件相匹配的数据才会被保留下来。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" e.empno, e.ename, d.deptno from emp e "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" dept d on e.deptno "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" d.deptno"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("左外连接")]),s._v(" "),e("p",[s._v("左外连接：JOIN 操作符左边表中符合 WHERE 子句的所有记录将会被返回。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" e.empno, e.ename, d.deptno from emp e left "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" dept d on e.deptno "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" d.deptno"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("右外连接")]),s._v(" "),e("p",[s._v("右外连接：JOIN 操作符右边表中符合 WHERE 子句的所有记录将会被返回")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empno"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ename"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" d"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("deptno "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp e "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("right")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("join")]),s._v(" dept d "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("deptno "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" d"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("deptno"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("满外连接")]),s._v(" "),e("p",[s._v("满外连接：将会返回所有表中符合 WHERE 语句条件的所有记录。如果任一表的指定字段没有符合条件的值的话，那么就使用 NULL 值替代。")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empno"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ename"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" d"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("deptno "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" emp e "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("full")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("join")]),s._v(" dept d "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" e"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("deptno "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" d"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("deptno"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("多表连接")]),s._v(" "),e("p",[s._v("注意：连接 n 个表，至少需要 n-1 个连接条件。例如：连接三个表，至少需要两个连接条件。")])])]),s._v(" "),e("h1",{attrs:{id:"排序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#排序"}},[s._v("#")]),s._v(" 排序")]),s._v(" "),e("h3",{attrs:{id:"order-by"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#order-by"}},[s._v("#")]),s._v(" Order By")]),s._v(" "),e("ol",[e("li",[s._v("Order By：全局排序，只有一个 Reducer")]),s._v(" "),e("li",[s._v("ASC（ascend）: 升序（默认）")]),s._v(" "),e("li",[s._v("DESC（descend）: 降序")])]),s._v(" "),e("h3",{attrs:{id:"sort-by"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sort-by"}},[s._v("#")]),s._v(" Sort By")]),s._v(" "),e("p",[s._v("Sort By：对于大规模的数据集 order by 的效率非常低。在很多情况下，并不需要全局排序，此时可以使用 sort by。")]),s._v(" "),e("p",[s._v("Sort by 为每个 reducer 产生一个排序文件。每个 Reducer 内部进行排序，对全局结果集来说不是排序。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置reduce个数")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" mapreduce.job.reduces"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看reduce个数")]),s._v("\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"distribute-by"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#distribute-by"}},[s._v("#")]),s._v(" Distribute By")]),s._v(" "),e("p",[s._v("Distribute By： 在有些情况下，我们需要控制某个特定行应该到哪个 reducer，通常是为了进行后续的聚集操作。"),e("strong",[s._v("distribute by")]),s._v(" 子句可以做这件事。"),e("strong",[s._v("distribute by")]),s._v(" 类似 MR 中 partition（自定义分区），进行分区，结合 sort by 使用。")]),s._v(" "),e("p",[s._v("对于 distribute by 进行测试，一定要分配多 reduce 进行处理，否则无法看到 distribute by 的效果。")]),s._v(" "),e("p",[e("strong",[s._v("注意：")])]),s._v(" "),e("ol",[e("li",[s._v("distribute by 的分区规则是根据分区字段的 hash 码与 reduce 的个数进行模除后，余数相同的分到一个区。 distribute by 的分区规则是根据分区字段的 hash 码与 reduce 的个数进行模除后，余数相同的分到一个区。")]),s._v(" "),e("li",[s._v("Hive 要求 DISTRIBUTE BY 语句要写在 SORT BY 语句之前")])]),s._v(" "),e("h3",{attrs:{id:"cluster-by"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cluster-by"}},[s._v("#")]),s._v(" Cluster By")]),s._v(" "),e("p",[s._v("当 distribute by 和 sorts by 字段相同时，可以使用 cluster by 方式。")]),s._v(" "),e("p",[s._v("cluster by 除了具有 distribute by 的功能外还兼具 sort by 的功能。但是排序只能是升序排序，不能指定排序规则为 ASC 或者 DESC")]),s._v(" "),e("p",[e("strong",[s._v("以下两种等价写法")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" * from emp cluster by deptno"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" * from emp distribute by deptno "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" by deptno"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);