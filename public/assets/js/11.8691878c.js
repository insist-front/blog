(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{582:function(s,a,n){s.exports=n.p+"assets/img/1.e8dbff9c.jpg"},583:function(s,a,n){s.exports=n.p+"assets/img/2.7d9fa3cf.jpg"},584:function(s,a,n){s.exports=n.p+"assets/img/3.436b7337.jpg"},585:function(s,a,n){s.exports=n.p+"assets/img/4.7c92aba8.jpg"},586:function(s,a,n){s.exports=n.p+"assets/img/5.f0bde897.jpg"},587:function(s,a,n){s.exports=n.p+"assets/img/6.261de630.jpg"},588:function(s,a,n){s.exports=n.p+"assets/img/7.18ce95e3.jpg"},589:function(s,a,n){s.exports=n.p+"assets/img/8.dd763b19.jpg"},672:function(s,a,n){"use strict";n.r(a);var e=n(9),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"flume安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#flume安装"}},[s._v("#")]),s._v(" Flume安装")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("上传文件并解压")])]),s._v(" "),e("li",[e("p",[s._v("将flume/conf下的flume-env.sh.template文件修改为flume-env.sh并配置 flume-env.sh文件")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" flume-env.sh.template flume-env.sh\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" flume-env.sh\n\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JAVA_HOME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/java/jdk1.8.0_191-amd64\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"入门案例-netcat-source"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#入门案例-netcat-source"}},[s._v("#")]),s._v(" 入门案例(NetCat Source)")]),s._v(" "),e("p",[e("img",{attrs:{src:n(582),alt:""}})]),s._v(" "),e("h3",{attrs:{id:"实现步骤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实现步骤"}},[s._v("#")]),s._v(" 实现步骤")]),s._v(" "),e("ol",[e("li",[e("p",[s._v("安装netcat工具")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("nc")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("判断 44444 端口是否被占用")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -tunlp "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("44444")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("创建 Flume Agent 配置文件 flume-netcat-logger.conf")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" job\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" job/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("在 job 文件夹下创建 Flume Agent 配置文件 flume-netcat-logger.conf")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" flume-netcat-logger.conf\n\n添加内容如下：\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na1.sources "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na1.sinks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na1.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na1.sources.r1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" netcat\na1.sources.r1.bind "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" localhost\na1.sources.r1.port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("44444")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na1.sinks.k1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" logger\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Use a channel which buffers events in memory")]),s._v("\na1.channels.c1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na1.channels.c1.capacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na1.channels.c1.transactionCapacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na1.sources.r1.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks.k1.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br")])]),e("p",[e("img",{attrs:{src:n(583),alt:""}})])]),s._v(" "),e("li",[e("p",[s._v("先开启 flume 监听端口")])])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 第一种")]),s._v("\nbin/flume-ng agent --conf conf/ --name a1 --conf-file job/flume-netcat-logger.conf -Dflume.root.logger"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("INFO,console\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 第二种")]),s._v("\nbin/flume-ng agent -c conf/ -n a1 -f job/flume-netcat-logger.conf -Dflume.root.logger"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("INFO,console\n\n参数说明：\n--conf/-c：表示配置文件存储在 conf/目录\n--name/-n：表示给 agent 起名为 a1\n--conf-file/-f：flume 本次启动读取的配置文件是在 job 文件夹下的 flume-telnet.conf\n文件。-Dflume.root.logger"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("INFO,console ：-D 表示 flume 运行时动态修改 flume.root.logger\n参数属性值，并将控制台日志打印级别设置为 INFO 级别。日志级别包括:log、info、warn、error。\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("ol",{attrs:{start:"5"}},[e("li",[e("p",[s._v("使用 netcat 工具向本机的 44444 端口发送内容")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("nc")]),s._v(" localhost "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("44444")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("h1",{attrs:{id:"实时监控单个追加文件-exec-source"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实时监控单个追加文件-exec-source"}},[s._v("#")]),s._v(" 实时监控单个追加文件(Exec Source)")]),s._v(" "),e("p",[e("img",{attrs:{src:n(584),alt:""}})]),s._v(" "),e("ol",[e("li",[e("p",[s._v("Flume 要想将数据输出到 HDFS，须持有 Hadoop 相关 jar 包")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("将\n\ncommons-configuration-1.6.jar、\nhadoop-auth-2.7.2.jar、\nhadoop-common-2.7.2.jar、\nhadoop-hdfs-2.7.2.jar、\ncommons-io-2.4.jar、\nhtrace-core-3.1.0-incubating.jar\n\n拷贝到/opt/module/flume/lib 文件夹下\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("创建 flume-file-hdfs.conf 文件")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" flume-file-hdfs.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("添加内容")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na2.sources "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r2\na2.sinks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k2\na2.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c2\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na2.sources.r2.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v("\na2.sources.r2.command "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -F /opt/module/hive/logs/hive.log\na2.sources.r2.shell "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /bin/bash -c\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na2.sinks.k2.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs\na2.sinks.k2.hdfs.path "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs://master:8020/flume/%Y%m%d/%H\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#上传文件的前缀")]),s._v("\na2.sinks.k2.hdfs.filePrefix "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" logs-\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#是否按照时间滚动文件夹")]),s._v("\na2.sinks.k2.hdfs.round "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多少时间单位创建一个新的文件夹")]),s._v("\na2.sinks.k2.hdfs.roundValue "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重新定义时间单位")]),s._v("\na2.sinks.k2.hdfs.roundUnit "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hour\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#是否使用本地时间戳")]),s._v("\na2.sinks.k2.hdfs.useLocalTimeStamp "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#积攒多少个 Event 才 flush 到 HDFS 一次")]),s._v("\na2.sinks.k2.hdfs.batchSize "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置文件类型，可支持压缩")]),s._v("\na2.sinks.k2.hdfs.fileType "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" DataStream\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多久生成一个新的文件")]),s._v("\na2.sinks.k2.hdfs.rollInterval "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置每个文件的滚动大小")]),s._v("\na2.sinks.k2.hdfs.rollSize "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("134217700")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#文件的滚动与 Event 数量无关")]),s._v("\na2.sinks.k2.hdfs.rollCount "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Use a channel which buffers events in memory")]),s._v("\na2.channels.c2.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na2.channels.c2.capacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na2.channels.c2.transactionCapacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na2.sources.r2.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c2\na2.sinks.k2.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c2\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br")])]),e("p",[e("strong",[s._v("注意：")])]),s._v(" "),e("p",[s._v("对于所有与时间相关的转义序列，Event Header 中必须存在以 “timestamp”的 key（除非hdfs.useLocalTimeStamp 设置为 true，此方法会使用 TimestampInterceptor 自动添加timestamp）。")]),s._v(" "),e("p",[s._v("a3.sinks.k3.hdfs.useLocalTimeStamp = true")]),s._v(" "),e("p",[e("img",{attrs:{src:n(585),alt:""}})])]),s._v(" "),e("li",[e("p",[s._v("运行Flume")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("bin/flume-ng agent --conf conf/ --name a2 --conf-file job/flume-file-hdfs.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("hadoop web查看文件")])])]),s._v(" "),e("p",[s._v("**注意：**有数据丢失或者重复问题")]),s._v(" "),e("h1",{attrs:{id:"实时监控目录下多个文件-spooldir-source"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实时监控目录下多个文件-spooldir-source"}},[s._v("#")]),s._v(" 实时监控目录下多个文件(Spooldir Source)")]),s._v(" "),e("p",[e("img",{attrs:{src:n(586),alt:""}})]),s._v(" "),e("ol",[e("li",[e("p",[s._v("创建配置文件")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" flume-dir-hdfs.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("添加内容")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("a3.sources "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r3\na3.sinks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k3\na3.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c3\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na3.sources.r3.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" spooldir\na3.sources.r3.spoolDir "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /opt/module/flume/upload\na3.sources.r3.fileSuffix "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .COMPLETED\na3.sources.r3.fileHeader "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#忽略所有以.tmp 结尾的文件，不上传")]),s._v("\na3.sources.r3.ignorePattern "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("^ "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("*"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(".tmp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na3.sinks.k3.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs\na3.sinks.k3.hdfs.path "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs://master:8020/flume/upload/%Y%m%d/%H\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#上传文件的前缀")]),s._v("\na3.sinks.k3.hdfs.filePrefix "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" upload-\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#是否按照时间滚动文件夹")]),s._v("\na3.sinks.k3.hdfs.round "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多少时间单位创建一个新的文件夹")]),s._v("\na3.sinks.k3.hdfs.roundValue "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重新定义时间单位")]),s._v("\na3.sinks.k3.hdfs.roundUnit "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hour\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#是否使用本地时间戳")]),s._v("\na3.sinks.k3.hdfs.useLocalTimeStamp "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#积攒多少个 Event 才 flush 到 HDFS 一次")]),s._v("\na3.sinks.k3.hdfs.batchSize "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置文件类型，可支持压缩")]),s._v("\na3.sinks.k3.hdfs.fileType "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" DataStream\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多久生成一个新的文件")]),s._v("\na3.sinks.k3.hdfs.rollInterval "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置每个文件的滚动大小大概是 128M")]),s._v("\na3.sinks.k3.hdfs.rollSize "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("134217700")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#文件的滚动与 Event 数量无关")]),s._v("\na3.sinks.k3.hdfs.rollCount "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Use a channel which buffers events in memory")]),s._v("\na3.channels.c3.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na3.channels.c3.capacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na3.channels.c3.transactionCapacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na3.sources.r3.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c3\na3.sinks.k3.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c3\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br")])]),e("p",[e("img",{attrs:{src:n(587),alt:""}})])]),s._v(" "),e("li",[e("p",[s._v("启动监控文件夹命令")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("bin/flume-ng agent --conf conf/ --name a3 --conf-file job/flume-dir-hdfs.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("说明：")])]),s._v(" "),e("p",[s._v("在使用 Spooling Directory Source 时不要在监控目录中创建并持续修改文件")]),s._v(" "),e("p",[s._v("上传完成的文件会以.COMPLETED 结尾")]),s._v(" "),e("p",[s._v("被监控文件夹每 500 毫秒扫描一次文件变动")])]),s._v(" "),e("li",[e("p",[s._v("向 upload 文件夹中添加文件")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" upload\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" atguigu.txt\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" atguigu.tmp\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("查看 HDFS 上的数据")])])]),s._v(" "),e("h1",{attrs:{id:"实时监控目录下的多个追加文件-taildir-source"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实时监控目录下的多个追加文件-taildir-source"}},[s._v("#")]),s._v(" 实时监控目录下的多个追加文件(Taildir Source)")]),s._v(" "),e("p",[e("img",{attrs:{src:n(588),alt:""}})]),s._v(" "),e("ol",[e("li",[e("p",[s._v("创建配置文件 flume-taildir-hdfs.conf")]),s._v(" "),e("p",[s._v("添加内容")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("a3.sources "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r3\na3.sinks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k3\na3.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c3\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na3.sources.r3.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" TAILDIR\na3.sources.r3.positionFile "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /opt/module/flume/tail_dir.json\na3.sources.r3.filegroups "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" f1\na3.sources.r3.filegroups.f1 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /opt/module/flume/files/file.*\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na3.sinks.k3.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs\na3.sinks.k3.hdfs.path "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" \nhdfs://hadoop102:9000/flume/upload/%Y%m%d/%H\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#上传文件的前缀")]),s._v("\na3.sinks.k3.hdfs.filePrefix "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" upload- "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#是否按照时间滚动文件夹")]),s._v("\na3.sinks.k3.hdfs.round "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多少时间单位创建一个新的文件夹")]),s._v("\na3.sinks.k3.hdfs.roundValue "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重新定义时间单位")]),s._v("\na3.sinks.k3.hdfs.roundUnit "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hour\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#是否使用本地时间戳")]),s._v("\na3.sinks.k3.hdfs.useLocalTimeStamp "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#积攒多少个 Event 才 flush 到 HDFS 一次")]),s._v("\na3.sinks.k3.hdfs.batchSize "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置文件类型，可支持压缩")]),s._v("\na3.sinks.k3.hdfs.fileType "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" DataStream\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多久生成一个新的文件")]),s._v("\na3.sinks.k3.hdfs.rollInterval "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置每个文件的滚动大小大概是 128M")]),s._v("\na3.sinks.k3.hdfs.rollSize "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("134217700")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#文件的滚动与 Event 数量无关")]),s._v("\na3.sinks.k3.hdfs.rollCount "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Use a channel which buffers events in memory")]),s._v("\na3.channels.c3.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na3.channels.c3.capacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na3.channels.c3.transactionCapacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na3.sources.r3.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c3\na3.sinks.k3.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c3\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br")])]),e("p",[e("img",{attrs:{src:n(589),alt:""}})])]),s._v(" "),e("li",[e("p",[s._v("启动监控文件夹命令")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("bin/flume-ng agent --conf conf/ --name a3 --conf-file job/flume-taildir-hdfs.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("向 files 文件夹中追加内容")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" files\n\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" hello "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" file1.txt\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" atguigu "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" file2.txt\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("查看 HDFS 上的数据")])])]),s._v(" "),e("p",[e("strong",[s._v("Taildir 说明：")])]),s._v(" "),e("p",[s._v("Taildir Source 维护了一个 json 格式的 position File，其会定期的往 position File中更新每个文件读取到的最新的位置，因此能够实现断点续传。Position File 的格式如下：")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"inode"')]),s._v(":2496272,"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pos"')]),s._v(":12,"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"file"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/module/flume/files/file1.txt"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"inode"')]),s._v(":2496275,"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pos"')]),s._v(":12,"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"file"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/module/flume/files/file2.txt"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("注：Linux 中储存文件元数据的区域就叫做 inode，每个 inode 都有一个号码，操作系统用 inode 号码来识别不同的文件，Unix/Linux 系统内部不使用文件名，而使用 inode 号码来")])])}),[],!1,null,null,null);a.default=t.exports}}]);