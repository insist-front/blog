(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{639:function(a,t,s){a.exports=s.p+"assets/img/1.60b74877.png"},640:function(a,t,s){a.exports=s.p+"assets/img/2.73ba0607.png"},641:function(a,t,s){a.exports=s.p+"assets/img/3.9aaf539a.png"},642:function(a,t,s){a.exports=s.p+"assets/img/4.34cd7d29.png"},687:function(a,t,s){"use strict";s.r(t);var n=s(9),r=Object(n.a)({},(function(){var a=this,t=a.$createElement,n=a._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[n("h1",{attrs:{id:"spark简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#spark简介"}},[a._v("#")]),a._v(" Spark简介")]),a._v(" "),n("p",[a._v("Spark 是一种基于内存的快速、通用、可扩展的大数据分析计算引擎")]),a._v(" "),n("h1",{attrs:{id:"spark核心模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#spark核心模块"}},[a._v("#")]),a._v(" Spark核心模块")]),a._v(" "),n("p",[n("img",{attrs:{src:s(639),alt:""}})]),a._v(" "),n("ol",[n("li",[n("p",[n("strong",[a._v("Spark Core")])]),a._v(" "),n("p",[a._v("Spark Core 中提供了 Spark 最基础与最核心的功能，Spark 其他的功能如：Spark SQL，Spark Streaming，GraphX, MLlib 都是在 Spark Core 的基础上进行扩展的")])]),a._v(" "),n("li",[n("p",[n("strong",[a._v("Spark SQL")])]),a._v(" "),n("p",[a._v("Spark SQL 是 Spark 用来操作结构化数据的组件。通过 Spark SQL，用户可以使用 SQL或者 Apache Hive 版本的 SQL 方言（HQL）来查询数据。")])]),a._v(" "),n("li",[n("p",[n("strong",[a._v("Spark Streaming")])]),a._v(" "),n("p",[a._v("Spark Streaming 是 Spark 平台上针对实时数据进行流式计算的组件，提供了丰富的处理数据流的 API")])]),a._v(" "),n("li",[n("p",[n("strong",[a._v("Spark MLlib")])]),a._v(" "),n("p",[a._v("MLlib 是 Spark 提供的一个机器学习算法库。MLlib 不仅提供了模型评估、数据导入等额外的功能，还提供了一些更底层的机器学习原语。")])]),a._v(" "),n("li",[n("p",[n("strong",[a._v("Spark GraphX")])]),a._v(" "),n("p",[a._v("GraphX 是 Spark 面向图计算提供的框架与算法库")])])]),a._v(" "),n("h1",{attrs:{id:"spark快速上手"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#spark快速上手"}},[a._v("#")]),a._v(" Spark快速上手")]),a._v(" "),n("ol",[n("li",[n("p",[a._v("Scala环境")])]),a._v(" "),n("li",[n("p",[a._v("添加Spark依赖")]),a._v(" "),n("div",{staticClass:"language-xml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependencies")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n \t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("org.apache.spark"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n \t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("spark-core_2.12"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n \t"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("3.0.0"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependencies")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br")])])]),a._v(" "),n("li",[n("p",[a._v("编写代码")]),a._v(" "),n("div",{staticClass:"language-scala line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-scala"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("object")]),a._v(" Spark_02_Spark_WordCount "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("def")]),a._v(" main"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("args"),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" Array"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("Unit")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 创建Spark运行配置对象")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("val")]),a._v(" sparkConf "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" SparkConf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("setMaster"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"local"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("setAppName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"wordcount"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//创建Spark上下文对象")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("val")]),a._v(" sparkContext "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" SparkContext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("sparkConf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 业务逻辑")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//1.读取文件数据")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("val")]),a._v(" wordRDD"),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v("RDD"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sparkContext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("textFile"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"bigdata_08_spark/datas"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 扁平化")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("val")]),a._v(" wordFlatMapRDD"),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" RDD"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" wordRDD"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("flatMap"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('" "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 每个元素打上 1")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("val")]),a._v(" value"),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" RDD"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("Int")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" wordFlatMapRDD"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("map"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// Spark提供根据key 将value做reduce操作")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("val")]),a._v(" res"),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" RDD"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("Int")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("reduceByKey"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_ "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" _"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 打印")]),a._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("foreach"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("println"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//关闭资源")]),a._v("\n    sparkContext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("stop"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br"),n("span",{staticClass:"line-number"},[a._v("15")]),n("br"),n("span",{staticClass:"line-number"},[a._v("16")]),n("br"),n("span",{staticClass:"line-number"},[a._v("17")]),n("br"),n("span",{staticClass:"line-number"},[a._v("18")]),n("br"),n("span",{staticClass:"line-number"},[a._v("19")]),n("br"),n("span",{staticClass:"line-number"},[a._v("20")]),n("br"),n("span",{staticClass:"line-number"},[a._v("21")]),n("br"),n("span",{staticClass:"line-number"},[a._v("22")]),n("br"),n("span",{staticClass:"line-number"},[a._v("23")]),n("br")])])])]),a._v(" "),n("h1",{attrs:{id:"去除日志信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#去除日志信息"}},[a._v("#")]),a._v(" 去除日志信息")]),a._v(" "),n("p",[a._v("执行过程中，会产生大量的执行日志，如果为了能够更好的查看程序的执行结果，可以在项")]),a._v(" "),n("p",[a._v("目的 resources 目录中创建 log4j.properties 文件，并添加日志配置信息：")]),a._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("log4j.rootCategory")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("ERROR, console")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("log4j.appender.console")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("org.apache.log4j.ConsoleAppender")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("log4j.appender.console.target")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("System.err")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("log4j.appender.console.layout")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("org.apache.log4j.PatternLayout")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("log4j.appender.console.layout.ConversionPattern")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("%d{yy/MM/dd ")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("HH")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("mm:ss} %p %c{1}: %m%n")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Set the default spark-shell log level to ERROR. When running the spark-shell, ")]),a._v("\nthe\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# log level for this class is used to overwrite the root logger's log level, so ")]),a._v("\nthat\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# the user can have different defaults for the shell and regular Spark apps.")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("log4j.logger.org.apache.spark.repl.Main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("ERROR")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Settings to quiet third party logs that are too verbose")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("log4j.logger.org.spark_project.jetty")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("ERROR")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("log4j.logger.org.spark_project.jetty.util.component.AbstractLifeCycle")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("ERROR")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("log4j.logger.org.apache.spark.repl.SparkIMain$exprTyper")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("ERROR")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("log4j.logger.org.apache.spark.repl.SparkILoop$SparkILoopInterpreter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("ERROR")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("log4j.logger.org.apache.parquet")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("ERROR")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("log4j.logger.parquet")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("ERROR")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# SPARK-9183: Settings to avoid annoying messages when looking up nonexistent ")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("UDFs")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("in SparkSQL with Hive support")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("log4j.logger.org.apache.hadoop.hive.metastore.RetryingHMSHandler")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("FATAL")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("log4j.logger.org.apache.hadoop.hive.ql.exec.FunctionRegistry")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("ERROR")]),a._v("\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br"),n("span",{staticClass:"line-number"},[a._v("15")]),n("br"),n("span",{staticClass:"line-number"},[a._v("16")]),n("br"),n("span",{staticClass:"line-number"},[a._v("17")]),n("br"),n("span",{staticClass:"line-number"},[a._v("18")]),n("br"),n("span",{staticClass:"line-number"},[a._v("19")]),n("br"),n("span",{staticClass:"line-number"},[a._v("20")]),n("br"),n("span",{staticClass:"line-number"},[a._v("21")]),n("br"),n("span",{staticClass:"line-number"},[a._v("22")]),n("br"),n("span",{staticClass:"line-number"},[a._v("23")]),n("br")])]),n("h1",{attrs:{id:"spark运行环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#spark运行环境"}},[a._v("#")]),a._v(" Spark运行环境")]),a._v(" "),n("p",[a._v("Spark 作为一个数据处理框架和计算引擎，被设计在所有常见的集群环境中运行, 在国内工作中主流的环境为 Yarn，不过逐渐容器式环境也慢慢流行起来。接下来，我们就分别看看不同环境下 Spark 的运行")]),a._v(" "),n("p",[n("img",{attrs:{src:s(640),alt:""}})]),a._v(" "),n("h2",{attrs:{id:"local模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#local模式"}},[a._v("#")]),a._v(" Local模式")]),a._v(" "),n("p",[a._v("所谓的 Local 模式，就是不需要其他任何节点资源就可以在本地执行 Spark 代码的环境，一般用于教学，调试，演示等，之前在 IDEA 中运行代码的环境我们称之为开发环境，不太一样")]),a._v(" "),n("ol",[n("li",[n("p",[a._v("解压文件")])]),a._v(" "),n("li",[n("p",[a._v("解压文件")]),a._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" -zxvf spark-3.0.0-bin-hadoop3.2.tgz -C /opt/module\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/module \n"),n("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" spark-3.0.0-bin-hadoop3.2 spark-local\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br")])])]),a._v(" "),n("li",[n("p",[a._v("启动Local环境")]),a._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[a._v("bin/spark-shell\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br")])]),n("p",[a._v("运行后会在问价中创建data文件夹")])]),a._v(" "),n("li",[n("p",[a._v("执行代码")]),a._v(" "),n("p",[n("img",{attrs:{src:s(641),alt:""}})])]),a._v(" "),n("li",[n("p",[a._v("通过浏览器访问")]),a._v(" "),n("p",[n("img",{attrs:{src:s(642),alt:""}})])])])])}),[],!1,null,null,null);t.default=r.exports}}]);