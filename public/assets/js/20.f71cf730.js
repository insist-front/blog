(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{604:function(s,a,n){s.exports=n.p+"assets/img/16.4a199243.jpg"},605:function(s,a,n){s.exports=n.p+"assets/img/17.65dec5b5.jpg"},606:function(s,a,n){s.exports=n.p+"assets/img/18.74daa6f2.jpg"},679:function(s,a,n){"use strict";n.r(a);var e=n(9),t=Object(e.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"复制和多路复用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#复制和多路复用"}},[s._v("#")]),s._v(" 复制和多路复用")]),s._v(" "),e("p",[e("strong",[s._v("描述")])]),s._v(" "),e("p",[s._v("使用 Flume-1 监控文件变动，Flume-1 将变动内容传递给 Flume-2，Flume-2 负责存储到 HDFS。同时 Flume-1 将变动内容传递给 Flume-3，Flume-3 负责输出到 Local FileSystem")]),s._v(" "),e("p",[e("img",{attrs:{src:n(604),alt:""}})]),s._v(" "),e("p",[e("strong",[s._v("创建flume-file-flume.conf")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na1.sources "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na1.sinks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1 k2\na1.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1 c2\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将数据流复制给所有 channel")]),s._v("\na1.sources.r1.selector.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" replicating\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na1.sources.r1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v("\na1.sources.r1.command "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -F /opt/module/hive/logs/hive.log\na1.sources.r1.shell "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /bin/bash -c\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sink 端的 avro 是一个数据发送者")]),s._v("\na1.sinks.k1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na1.sinks.k1.hostname "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na1.sinks.k1.port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4141")]),s._v("\na1.sinks.k2.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na1.sinks.k2.hostname "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na1.sinks.k2.port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4142")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na1.channels.c1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na1.channels.c1.capacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na1.channels.c1.transactionCapacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\na1.channels.c2.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na1.channels.c2.capacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na1.channels.c2.transactionCapacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na1.sources.r1.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1 c2\na1.sinks.k1.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks.k2.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c2\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br")])]),e("p",[e("strong",[s._v("创建 flume-flume-hdfs.conf")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na2.sources "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na2.sinks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na2.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# source 端的 avro 是一个数据接收服务")]),s._v("\na2.sources.r1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na2.sources.r1.bind "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na2.sources.r1.port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4141")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na2.sinks.k1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs\na2.sinks.k1.hdfs.path "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hdfs://hadoop102:9000/flume2/%Y%m%d/%H\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#上传文件的前缀")]),s._v("\na2.sinks.k1.hdfs.filePrefix "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" flume2- "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#是否按照时间滚动文件夹")]),s._v("\na2.sinks.k1.hdfs.round "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多少时间单位创建一个新的文件夹")]),s._v("\na2.sinks.k1.hdfs.roundValue "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重新定义时间单位")]),s._v("\na2.sinks.k1.hdfs.roundUnit "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hour\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#是否使用本地时间戳")]),s._v("\na2.sinks.k1.hdfs.useLocalTimeStamp "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#积攒多少个 Event 才 flush 到 HDFS 一次")]),s._v("\na2.sinks.k1.hdfs.batchSize "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置文件类型，可支持压缩")]),s._v("\na2.sinks.k1.hdfs.fileType "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" DataStream\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多久生成一个新的文件")]),s._v("\na2.sinks.k1.hdfs.rollInterval "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置每个文件的滚动大小大概是 128M")]),s._v("\na2.sinks.k1.hdfs.rollSize "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("134217700")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#文件的滚动与 Event 数量无关")]),s._v("\na2.sinks.k1.hdfs.rollCount "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na2.channels.c1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na2.channels.c1.capacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na2.channels.c1.transactionCapacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na2.sources.r1.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na2.sinks.k1.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br")])]),e("p",[e("strong",[s._v("创建 flume-flume-dir.conf")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na3.sources "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na3.sinks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na3.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c2\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na3.sources.r1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na3.sources.r1.bind "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na3.sources.r1.port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4142")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na3.sinks.k1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" file_roll\na3.sinks.k1.sink.directory "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /opt/module/data/flume3\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na3.channels.c2.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na3.channels.c2.capacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na3.channels.c2.transactionCapacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na3.sources.r1.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c2\na3.sinks.k1.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c2\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br")])]),e("p",[e("strong",[s._v("执行配置文件")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("bin/flume-ng agent --conf conf/ --name a3 --conf-file job/group1/flume-flume-dir.conf\n\nbin/flume-ng agent --conf conf/ --name a2 --conf-file job/group1/flume-flume-hdfs.conf\n\nbin/flume-ng agent --conf conf/ --name a1 --conf-file job/group1/flume-file-flume.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h1",{attrs:{id:"负载均衡和故障转移"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#负载均衡和故障转移"}},[s._v("#")]),s._v(" 负载均衡和故障转移")]),s._v(" "),e("p",[e("strong",[s._v("描述")])]),s._v(" "),e("p",[s._v("使用 Flume1 监控一个端口，其 sink 组中的 sink 分别对接 Flume2 和 Flume3，采用FailoverSinkProcessor，实现故障转移的功能。")]),s._v(" "),e("p",[e("img",{attrs:{src:n(605),alt:""}})]),s._v(" "),e("p",[e("strong",[s._v("创建 flume-netcat-flume.conf")])]),s._v(" "),e("p",[s._v("配置 1 个 netcat source 和 1 个 channel、1 个 sink group（2 个 sink），分别输送给 flume-flume-console1 和 flume-flume-console2。")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na1.sources "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na1.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinkgroups "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" g1\na1.sinks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1 k2\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na1.sources.r1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" netcat\na1.sources.r1.bind "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" localhost\na1.sources.r1.port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("44444")]),s._v("\na1.sinkgroups.g1.processor.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" failover\na1.sinkgroups.g1.processor.priority.k1 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\na1.sinkgroups.g1.processor.priority.k2 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\na1.sinkgroups.g1.processor.maxpenalty "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na1.sinks.k1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na1.sinks.k1.hostname "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na1.sinks.k1.port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4141")]),s._v("\na1.sinks.k2.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na1.sinks.k2.hostname "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na1.sinks.k2.port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4142")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na1.channels.c1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na1.channels.c1.capacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na1.channels.c1.transactionCapacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na1.sources.r1.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinkgroups.g1.sinks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1 k2\na1.sinks.k1.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks.k2.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br")])]),e("p",[e("strong",[s._v("创建 flume-flume-console1.conf")])]),s._v(" "),e("p",[s._v("配置上级 Flume 输出的 Source，输出是到本地控制台")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na2.sources "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na2.sinks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na2.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na2.sources.r1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na2.sources.r1.bind "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na2.sources.r1.port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4141")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na2.sinks.k1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" logger\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na2.channels.c1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na2.channels.c1.capacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na2.channels.c1.transactionCapacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na2.sources.r1.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na2.sinks.k1.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("p",[e("strong",[s._v("创建 flume-flume-console2.conf")])]),s._v(" "),e("p",[s._v("配置上级 Flume 输出的 Source，输出是到本地控制台")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na3.sources "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na3.sinks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na3.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c2\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na3.sources.r1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na3.sources.r1.bind "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop102\na3.sources.r1.port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4142")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na3.sinks.k1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" logger\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na3.channels.c2.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na3.channels.c2.capacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na3.channels.c2.transactionCapacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na3.sources.r1.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c2\na3.sinks.k1.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c2\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br")])]),e("p",[e("strong",[s._v("执行配置文件")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("bin/flume-ng agent --conf conf/ --name a3 --conf-file job/group2/flume-flume-console2.conf -Dflume.root.logger"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("INFO,console\n\nbin/flume-ng agent --conf conf/ --name a2 --conf-file job/group2/flume-flume-console1.conf -Dflume.root.logger"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("INFO,console\n\nbin/flume-ng agent --conf conf/ --name a1 --conf-file job/group2/flume-netcat-flume.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[e("strong",[s._v("使用 netcat 工具向本机的 44444 端口发送内容")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("nc")]),s._v(" localhost "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("44444")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("查看 Flume2 及 Flume3 的控制台打印日志")])]),s._v(" "),e("p",[e("strong",[s._v("将 Flume2 kill，观察 Flume3 的控制台打印情况")])]),s._v(" "),e("h1",{attrs:{id:"聚合"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#聚合"}},[s._v("#")]),s._v(" 聚合")]),s._v(" "),e("p",[e("strong",[s._v("描述")])]),s._v(" "),e("p",[s._v("hadoop102 上的 Flume-1 监控文件/opt/module/data/group.log，")]),s._v(" "),e("p",[s._v("hadoop103 上的 Flume-2 监控某一个端口的数据流，")]),s._v(" "),e("p",[s._v("Flume-1 与 Flume-2 将数据发送给 hadoop104 上的 Flume-3，Flume-3 将最终数据打印到控制台。")]),s._v(" "),e("p",[e("img",{attrs:{src:n(606),alt:""}})]),s._v(" "),e("p",[e("strong",[s._v("分发 Flume")])]),s._v(" "),e("p",[e("strong",[s._v("创建 flume1-logger-flume.conf")])]),s._v(" "),e("p",[s._v("配置 Source 用于监控 hive.log 文件，配置 Sink 输出数据到下一级 Flume")]),s._v(" "),e("p",[s._v("在 hadoop102 上编辑配置文件")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na1.sources "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na1.sinks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na1.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na1.sources.r1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v("\na1.sources.r1.command "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -F /opt/module/group.log\na1.sources.r1.shell "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /bin/bash -c\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na1.sinks.k1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na1.sinks.k1.hostname "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop104\na1.sinks.k1.port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4141")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na1.channels.c1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na1.channels.c1.capacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na1.channels.c1.transactionCapacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na1.sources.r1.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na1.sinks.k1.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br")])]),e("p",[e("strong",[s._v("创建 flume2-netcat-flume.conf")])]),s._v(" "),e("p",[s._v("配置 Source 监控端口 44444 数据流，配置 Sink 数据到下一级 Flume：")]),s._v(" "),e("p",[s._v("在 hadoop103 上编辑配置文件")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na2.sources "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na2.sinks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na2.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na2.sources.r1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" netcat\na2.sources.r1.bind "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop103\na2.sources.r1.port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("44444")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na2.sinks.k1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na2.sinks.k1.hostname "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop104\na2.sinks.k1.port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4141")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Use a channel which buffers events in memory")]),s._v("\na2.channels.c1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na2.channels.c1.capacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na2.channels.c1.transactionCapacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na2.sources.r1.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na2.sinks.k1.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br")])]),e("p",[e("strong",[s._v("创建 flume3-flume-logger.conf")])]),s._v(" "),e("p",[s._v("配置 source 用于接收 flume1 与 flume2 发送过来的数据流，最终合并后 sink 到控制台。")]),s._v(" "),e("p",[s._v("在 hadoop104 上编辑配置文件")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Name the components on this agent")]),s._v("\na3.sources "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" r1\na3.sinks "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" k1\na3.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe/configure the source")]),s._v("\na3.sources.r1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" avro\na3.sources.r1.bind "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hadoop104\na3.sources.r1.port "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4141")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the sink")]),s._v("\na3.sinks.k1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" logger\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Describe the channel")]),s._v("\na3.channels.c1.type "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" memory\na3.channels.c1.capacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\na3.channels.c1.transactionCapacity "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Bind the source and sink to the channel")]),s._v("\na3.sources.r1.channels "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\na3.sinks.k1.channel "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" c1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br")])]),e("p",[e("strong",[s._v("执行配置文件")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("bin/flume-ng agent --conf conf/ --name a3 --conf-file job/group3/flume3-flume-logger.conf -Dflume.root.logger"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("INFO,console\n\nbin/flume-ng agent --conf conf/ --name a2 --conf-file job/group3/flume1-logger-flume.conf\n\nbin/flume-ng agent --conf conf/ --name a1 --conf-file job/group3/flume2-netcat-flume.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[e("strong",[s._v("在 hadoop103 上向/opt/module 目录下的 group.log 追加内容")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" group.log\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("在 hadoop102 上向 44444 端口发送数据")])]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("telnet hadoop102 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("44444")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("检查 hadoop104 上数据")])])])}),[],!1,null,null,null);a.default=t.exports}}]);